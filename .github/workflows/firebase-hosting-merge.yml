name: Firebase Deploy
on:
    push:
        branches:
            - main
jobs:
    build:
        name: Build
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Repo
              uses: actions/checkout@v2.3.2
            - name: Install Dependencies
              run: npm install
            - name: Build
              run: npm run build
            - name: Archive Production Artifact
              uses: actions/upload-artifact@v2
              with:
                  name: build
                  path: build
    deploy:
        name: Deploy
        needs: build
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Repo
              uses: actions/checkout@v2.3.2
            - name: Download Artifact
              uses: actions/download-artifact@v2
              with:
                  name: build
                  path: build
            - name: Deploy to Firebase
            - uses: FirebaseExtended/action-hosting-deploy@v0
              with:
                  repoToken: "${{ secrets.GITHUB_TOKEN }}"
                  firebaseServiceAccount: "${{ secrets.FIREBASE_SERVICE_ACCOUNT_PORT_ANALYTICS }}"
                  projectId: port-analytics
                  channelId: live
